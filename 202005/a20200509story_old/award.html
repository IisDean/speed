

<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge;chrome=1">
<meta name="renderer" content="webkit">
<!-- 保证移动端页面能够展示完整页面 -->
<meta name="viewport" content="width=device-width, maximum-scale=1.0">
<meta name="keywords" content="剑网3 剑网3推栏 剑网3推栏小说大赛 剑网3同人嘉年华 剑网3十周年">
<meta name="description" content="《剑网3推栏》是剑网3官方实用APP，剑网3推栏小说大赛已上线。剑网3推栏将为您提供实时分析竞技场数据、配装器工具。游戏聊天频道互通，世界频道、密聊频道、好友频道、门派频道、阵营频道,绑定游戏账号增加轻功气力值上限。">
<meta name="publish-date" content="Sat May 09 2020 16:19:26 GMT+0800 (中国标准时间)">
<meta name="author" content="黄日欣">
<title>作品列表-剑网3推栏小说大赛_剑网3十周年_剑网3同人嘉年华-剑网3官网</title>
  
<!--外部css资源从这里开始-->
<link class="external" href="//zhcdn01.xoyo.com/xassets/com/pf/reset/reset.css" rel="stylesheet">
<link href="//zhcdn01.xoyo.com/assets/lib/dialog/artDialog/skins/001/ui.css" class="external" rel="stylesheet">

  <!-- build:css assets/css/bundles.build.css -->
<link rel="stylesheet" href="assets/css/style.css">
<link rel="stylesheet" href="assets/css/result.css">
<!-- endbuild -->
<style>

</style>
  <!--[if lt IE 9]>
    <script src="//zhcdn01.xoyo.com/xassets/lib/shim/xfe/xfe-shim.min.js"></script>
<![endif]-->
<script>
  if (!window.Promise) {
    document.writeln('<script src="//zhcdn01.xoyo.com/xassets/lib/es6-promise/stable/es6-promise.auto.min.js"' + '>' + '<' + '/' + 'script>');
  }
</script>

  <script class>
  function getUrlParameter(parameterName) {
    var result = null,
      tmp = [];
    location.search
      .substr(1)
      .split("&")
      .forEach(function (item) {
        tmp = item.split("=");
        if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
      });
    return result;
  }
</script>

  <link rel="stylesheet" href="//zhcdn01.xoyo.com/xassets/lib/animatecss/animate.min.css">
  <script type="text/javascript">
    function IsPC() {
      var userAgentInfo = navigator.userAgent;
      var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod", "XiaoMi");
      var flag = true;
      for (var v = 0; v < Agents.length; v++) {
        if (userAgentInfo.indexOf(Agents[v]) > 0) {
          flag = false;
          break;
        }
      }
      return flag;
    }
    if (!IsPC()) {
      function getPageRouteByUrl() {
        const regText = /\/\w*.html/
        return window.location.href.match(regText)[0];
      }
      //如果不是pc端，则重定向至移动端
      const pageRoute = getPageRouteByUrl();
      switch(pageRoute){
        case '/list.html':{
          window.location.href="https://test-zt.xoyo.com/jx3.xoyo.com/m/2019/05/27/tongren-novel/#/";
          break;
        }
        case '/detail.html':{
          const id = getUrlParameter('id');
          window.location.href = `https://test-zt.xoyo.com/jx3.xoyo.com/m/2019/05/27/tongren-novel/#/details/${id}`;
          break;
        }
        case '/index.html':{
          window.location.href="https://test-zt.xoyo.com/jx3.xoyo.com/m/2019/05/27/tongren-novel/index.html"; //地址
          break;
        }
        case '/rule.html':{
          window.location.href="https://test-zt.xoyo.com/jx3.xoyo.com/m/2019/05/27/tongren-novel/#/rule"; //地址
          break;
        }
        case '/award.html':{
          window.location.href="https://test-zt.xoyo.com/jx3.xoyo.com/m/2019/05/27/tongren-novel/#/prize"; //地址
          break;
        }
      }
    }
  </script>

</head>
<body>

<!--[if lt IE 7]>
<div id="__IE_WARNING__" style="padding: 80px 0; width: 100%; text-align: center; line-height: 150%; font-size: 16px; background: #fff;">
    <h3>抱歉</h3>
    <p>由于官网使用HTML5技术，您的浏览器版本过低不能正常访问<br>建议您升级您的浏览器！既能享受新技术的革新，又能保障您的上网安全</p>
    <a href="http://browsehappy.osfipin.com/" style="color:red;">立即升级浏览器</a>
</div>
<![endif]-->
<!--
  调用这个组件的地方有：
  assets/scripts/main.js  里面的通用弹出提示方法  如果这里要改ns ，那么这里也要改

-->


    <script class>
  function getUrlParameter(parameterName) {
    var result = null,
      tmp = [];
    location.search
      .substr(1)
      .split("&")
      .forEach(function (item) {
        tmp = item.split("=");
        if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
      });
    return result;
  }
</script>

<!-- 搜索结果列表 -->
<div class="p-r page-container">
  <div class="p-a bg inset-up"></div>
  <div class="p-a bg inset-down"></div>
  <!-- 排序 -->
  <div class="p-r page-content">
    <div class="px-container">
      <p>筛&nbsp;&nbsp;选：</p>
      <a class="active" href="javascript: alert('敬请期待！');">时间 ↓</a>
      <span>|</span>
      <a href="javascript: alert('敬请期待！');">点赞数 ↓</a>
    </div>
    <ul class="result-list awrad-list c">
      <li class="f-l result-item">
        <a href="#">
          <div class="result-img">
            <img src="https://qdlm.pvp.xoyo.com/9927d634a5775aa789b676e0184b5584/197276a596c648aab4dc845f67863e9f?imageslim" alt="作品">
          </div>
          <div class="result-content">
            <div class="title-text t-hide">这是个标题可能稍微有点长有点长</p>
            <div class="author-text t-r">作者名字</div>
          </div>
        </a>
      </li>
      <li class="f-l result-item">
        <a href="#">
          <div class="result-img">
            <img src="https://qdlm.pvp.xoyo.com/9927d634a5775aa789b676e0184b5584/197276a596c648aab4dc845f67863e9f?imageslim" alt="作品">
          </div>
          <div class="result-content">
            <div class="title-text t-hide">这是个标题可能稍微有点长有点长</p>
            <div class="author-text t-r">作者名字</div>
          </div>
        </a>
      </li>
      <li class="f-l result-item">
        <a href="#">
          <div class="result-img">
            <img src="https://qdlm.pvp.xoyo.com/9927d634a5775aa789b676e0184b5584/197276a596c648aab4dc845f67863e9f?imageslim" alt="作品">
          </div>
          <div class="result-content">
            <div class="title-text t-hide">这是个标题可能稍微有点长有点长</p>
            <div class="author-text t-r">作者名字</div>
          </div>
        </a>
      </li>
      <li class="f-l result-item">
        <a href="#">
          <div class="result-img">
            <img src="https://qdlm.pvp.xoyo.com/9927d634a5775aa789b676e0184b5584/197276a596c648aab4dc845f67863e9f?imageslim" alt="作品">
          </div>
          <div class="result-content">
            <div class="title-text t-hide">这是个标题可能稍微有点长有点长</p>
            <div class="author-text t-r">作者名字</div>
          </div>
        </a>
      </li>
      <li class="f-l result-item">
        <a href="#">
          <div class="result-img">
            <img src="https://qdlm.pvp.xoyo.com/9927d634a5775aa789b676e0184b5584/197276a596c648aab4dc845f67863e9f?imageslim" alt="作品">
          </div>
          <div class="result-content">
            <div class="title-text t-hide">这是个标题可能稍微有点长有点长</p>
            <div class="author-text t-r">作者名字</div>
          </div>
        </a>
      </li>
      <li class="f-l result-item">
        <a href="#">
          <div class="result-img">
            <img src="https://qdlm.pvp.xoyo.com/9927d634a5775aa789b676e0184b5584/197276a596c648aab4dc845f67863e9f?imageslim" alt="作品">
          </div>
          <div class="result-content">
            <div class="title-text t-hide">这是个标题可能稍微有点长有点长</p>
            <div class="author-text t-r">作者名字</div>
          </div>
        </a>
      </li>
      <li class="f-l result-item">
        <a href="#">
          <div class="result-img">
            <img src="https://qdlm.pvp.xoyo.com/9927d634a5775aa789b676e0184b5584/197276a596c648aab4dc845f67863e9f?imageslim" alt="作品">
          </div>
          <div class="result-content">
            <div class="title-text t-hide">这是个标题可能稍微有点长有点长</p>
            <div class="author-text t-r">作者名字</div>
          </div>
        </a>
      </li>
      <li class="f-l result-item">
        <a href="#">
          <div class="result-img">
            <img src="https://qdlm.pvp.xoyo.com/9927d634a5775aa789b676e0184b5584/197276a596c648aab4dc845f67863e9f?imageslim" alt="作品">
          </div>
          <div class="result-content">
            <div class="title-text t-hide">这是个标题可能稍微有点长有点长</p>
            <div class="author-text t-r">作者名字</div>
          </div>
        </a>
      </li>
    </ul>
    <!-- 什么都没有找到 -->
    <div class="result-none" style="display: none;">
      <img src="./assets/images/search_none.png" alt="没有结果">
      <p class="t-c">哎呀~什么都没有找到呢~</p>
    </div>
    <!-- 分页 -->
    <div class="pagination-container c">
      <div class="pagination-left f-l">
        <a href="#" class="page-btn prev-btn">上一页</a>
        <a href="#" class="page-btn num-btn">1</a>
        <a href="#" class="page-btn num-btn">2</a>
        <a href="#" class="page-btn num-btn">3</a>
        <a href="#" class="page-btn num-btn">4</a>
        <a href="#" class="page-btn num-btn">5</a>
        <a href="#" class="page-btn num-btn none">...</a>
        <a href="#" class="page-btn num-btn">18</a>
        <a href="#" class="page-btn next-btn">下一页</a>
      </div>
      <div class="pagination-right f-r">
        <p>共18页，跳至</p>
        <input type="number" maxlength="18" />
        <p>页</p>
        <a href="#" class="page-btn next-btn">跳转</a>
      </div>
    </div>
  </div>
</div>

<!--外部资源从这里开始-->
<script class="external" src="//zhcdn01.xoyo.com/xassets/lib/jquery/1.7.2/jquery.min.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/lib/dialog/artDialog/4.1.7/artDialog.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/com/pf/register/jsreg/v2/register.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/com/pf/xpass/v1/xpass.test.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/com/jx3/navibar/v2/navibar.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/lib/st-report-sdk/stable/st-report-sdk.min.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/lib/jquery.cookie/1.4.1/jquery.cookie.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/assets/lib/jquery.inview/jquery.inview.min.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/lib/masonry/2.1.08/jquery.masonry.min.js"></script>
<script class="external" src="//jx3.xoyo.com/assets/page/tr/javascripts/jquery.pagination.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/com/pf/method/comMethod.js"></script>
<script class="external" src="assets/scripts/service.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/lib/xfe-request/v0/stable.min.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/com/pf/baiduShare/static/api/js/share.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/lib/dropload/0.9.1/dropload.min.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/lib/jquery.qrcode/jquery.qrcode.min.js"></script>
<script class="external" src="assets/scripts/service/index.js"></script>
<script class="external" src="//zhcdn01.xoyo.com/xassets/com/pf/footer/v3/black/footer.js"></script>

<!-- build:vendors assets/scripts/vendors.js -->
  <!--第三方脚本从这里开始-->
<!-- endbuild -->

<!-- build:js assets/scripts/bundles.build.js -->
<script src="assets/scripts/main.js"></script>
<script src="assets/scripts/error-handler.js"></script>
<!-- endbuild -->
<script>(function ($) {
  var o = $({});
  $.subscribe = function () {
    o.on.apply(o, arguments);
  };
  $.subscribeOnce = function (name, rawFunc) {
    var func = function func() {
      $.unsubscribe.apply(null, arguments);
      rawFunc.apply(this, arguments);
    };
    $.subscribe.apply(null, [name, func]);
  };
  $.unsubscribe = function () {
    o.off.apply(o, arguments);
  };
  $.publish = function () {
    console.log(arguments[0]);
    o.trigger.apply(o, arguments);
  };
})(jQuery);
(function () {
  $('.J_menu-rig-popsidebarPopMenu li').mouseenter(function () {
    $(this).find('.menu-rig-pop-menu-pop').show();
  });
  $('.J_menu-rig-popsidebarPopMenu li').mouseleave(function () {
    $(this).find('.menu-rig-pop-menu-pop').hide();
  });

  var webLink = window.location.href;
  webLink = webLink.split('.').join('');
  if (webLink.lastIndexOf('listhtml') > -1) {
    $('.J_menu-rig-popmenuPop01 a').eq(1).addClass('menu-rig-pop-cur-s');
  }
  if (webLink.lastIndexOf('indexhtml') > -1) {
    $('.J_menu-rig-popmenuPop01 a').eq(0).addClass('menu-rig-pop-cur-s');
  }
})();
$(window).on('scroll', function () {
  if (window.scrollY >= 400) {
    $('.menu-rig-pop').fadeIn(500);
  } else {
    $('.menu-rig-pop').fadeOut(500);
  }
});
(function () {
  $('.J_popupGlocloseBtn, .J_popupGlomask').on('click', function () {
    $('.J_popupGlomask, .J_popupGlotipsBox, .J_popupGlotipsRuleBox').fadeOut();
  });
})();
(function () {
  //获取页面加载的相关时间戳
  document.ready = function () {
    window.pageLoadBegin = +new Date();
  };
})();
/**
 *
 * @param eventName  事件名称，对应统计文档ev_n
 * @param eventDescription 事件描述，对应统计文档ev_desc
 * @param ret_code 错误提示码,常用于后端接口返回的错误状态码，如 -20001
 * @param ret_msg 错误提示文案，常用于后端接口返回错误描述，如： XX失败
 */

/**
 * 调用方法，比如： window.stReportGlobal('load_page','页面加载');
 */
window.stReportGlobal = function (eventName, eventDescription, searchInfo, ret_code, ret_msg) {
  var projectHost = window.location.host ? window.location.host : 'jx3.xoyo.com';
  var web_l = window.location.host || '';
  var web_l_join = web_l.split('.').join('');

  // * @param projectIdentifier [string] - 项目标识（[A-Za-z_]+{4, },内部约定），必选
  // * @param eventName [string] - 事件名称，（格式与时间分组一致），可选
  // * @param eventGroup [string] - 事件分组（[A-Za-z_\-]+{1,},内部约定），可选 ，对应统计文档： ev_g
  // * @param eventDescription [string]- 事件描述（字符串）
  // * @param eventDataValue [object] - 事件额外数据对象，kv对，可选, 如: evd[k1]=v1&evd[k2]
  // * @param eventTags [string[]] - 事件标签数组（格式与时间分组一致），可选 ，对应统计文档：ev_tag
  try {
    StReportSdk.getDefaultInstance('2019_05_06_jx3_xoyo_com_tongren-novel').report({
      eventName: eventName,
      projectIdentifier: web_l_join.lastIndexOf('xoyo') > -1 ? projectHost.split('.')[0] : 'jx3-test',
      eventDescription: eventDescription,
      eventTags: ['pc', 'tongren', 'zshd'],
      eventGroup: 'jx3_trxs_20190516',
      eventDataValue: {
        word: searchInfo,
        ret_code: ret_code,
        ret_msg: ret_msg
      }
    });
  } catch (e) {
    setTimeout(function () {
      throw e;
    });
  }
};
window.stReportWithName = function (eventName, eventDescription, workName) {
  var projectHost = window.location.host ? window.location.host : 'jx3.xoyo.com';
  var web_l = window.location.host || '';
  var web_l_join = web_l.split('.').join('');

  // * @param projectIdentifier [string] - 项目标识（[A-Za-z_]+{4, },内部约定），必选
  // * @param eventName [string] - 事件名称，（格式与时间分组一致），可选
  // * @param eventGroup [string] - 事件分组（[A-Za-z_\-]+{1,},内部约定），可选 ，对应统计文档： ev_g
  // * @param eventDescription [string]- 事件描述（字符串）
  // * @param eventDataValue [object] - 事件额外数据对象，kv对，可选, 如: evd[k1]=v1&evd[k2]
  // * @param eventTags [string[]] - 事件标签数组（格式与时间分组一致），可选 ，对应统计文档：ev_tag
  try {
    StReportSdk.getDefaultInstance('2019_05_06_jx3_xoyo_com_tongren-novel').report({
      eventName: eventName,
      projectIdentifier: web_l_join.lastIndexOf('xoyo') > -1 ? projectHost.split('.')[0] : 'jx3-test',
      eventDescription: eventDescription,
      eventTags: ['pc', 'tongren', 'zshd'],
      eventGroup: 'jx3_trxs_20190516',
      eventDataValue: {
        el_val: workName
      }
    });
  } catch (e) {
    setTimeout(function () {
      throw e;
    });
  }
};
window.stReportWithTimeStamp = function (eventName, eventDescription, timeStamp) {
  var projectHost = window.location.host ? window.location.host : 'jx3.xoyo.com';
  var web_l = window.location.host || '';
  var web_l_join = web_l.split('.').join('');
  // * @param projectIdentifier [string] - 项目标识（[A-Za-z_]+{4, },内部约定），必选
  // * @param eventName [string] - 事件名称，（格式与时间分组一致），可选
  // * @param eventGroup [string] - 事件分组（[A-Za-z_\-]+{1,},内部约定），可选 ，对应统计文档： ev_g
  // * @param eventDescription [string]- 事件描述（字符串）
  // * @param eventDataValue [object] - 事件额外数据对象，kv对，可选, 如: evd[k1]=v1&evd[k2]
  // * @param eventTags [string[]] - 事件标签数组（格式与时间分组一致），可选 ，对应统计文档：ev_tag
  try {
    StReportSdk.getDefaultInstance('2019_05_06_jx3_xoyo_com_tongren-novel').report({
      eventName: eventName,
      projectIdentifier: web_l_join.lastIndexOf('xoyo') > -1 ? projectHost.split('.')[0] : 'jx3-test',
      eventDescription: eventDescription,
      eventTags: ['pc', 'tongren', 'zshd'],
      eventGroup: 'jx3_trxs_20190516',
      eventDataValue: {
        td_pl: timeStamp
      }
    });
  } catch (e) {
    setTimeout(function () {
      throw e;
    });
  }
};
(function () {
  var webLink = window.location.href;
  webLink = webLink.split('.').join('');
  if (webLink.lastIndexOf('indexhtml') > -1) {
    $('.J_head-menumenu li').eq(0).addClass('head-menu-menu-on');
  } else if (webLink.lastIndexOf('listhtml') > -1) {
    $('.J_head-menumenu li').eq(1).addClass('head-menu-menu-on');
  } else if (webLink.lastIndexOf('awardhtml') > -1) {
    $('.J_head-menumenu li').eq(2).addClass('head-menu-menu-on');
  }
  XPASS.isLogin(function () {
    $('.J_head-menuloginSuccess').show();
  }, function () {

    if (webLink.lastIndexOf('join') > -1 || webLink.lastIndexOf('my-work') > -1 || webLink.lastIndexOf('tougao') > -1 || webLink.lastIndexOf('report') > -1) {
      //如果是我要参加页面 则弹出登录窗口
      XPASS.signin();
    }
  });

  if (webLink.lastIndexOf('listhtml') > -1 || webLink.lastIndexOf('searchhtml') > -1) {
    //如果是规则页和举报页，需要单独加搜索按钮功能
  } else {
    var seachEvent = function seachEvent(event) {
      var $this = $(event.target);
      var searchType = $this.attr('data-type');
      var keyword = $this.val() ? $this.val() : $this.siblings('.J_searchInfoText').val();
      window.stReportGlobal('click_search', '点击搜索', keyword);
      if (!keyword) {
        window.errorTips('请输入搜索内容');
        return;
      }
      window.scrollTo(0, 717);

      /**
       * 如果是搜索页 那么就不刷新 否则跳转到搜索结果页
       */
      window.location.href = 'search.html?keywords=' + keyword + '#searchtop';
    };
    $('.J_searchInfoBtn').on('click', seachEvent);
    $('.J_searchInfoText').on('keydown', function (event) {
      if (event.keyCode == 13) {
        seachEvent(event);
      }
    });
  }

  $('.J_head-menujoinBtn').on('click', function () {
    window.stReportGlobal('click_publish_work_top', '投稿');
    if ($.cookie('isClickAgreeRule') === 'agreement') {
      window.location.href = 'join.html';
    } else {
      $('.J_popupGlotipsRuleBox, .J_popupGlomask').fadeIn();
      $.cookie('isClickAgreeRule', 'agreement', { expires: 800 });
    }
  });
})();

(function () {
  $('.detail .detail-content .works-manage').on('click', function (e) {
    e.preventDefault();
    window.stReportGlobal('click_publish_my_work', '作品管理');
    window.location.href = 'my-work.html';
  });
  $('.detail .detail-content .notice').on('click', function (e) {
    e.preventDefault();
    window.stReportGlobal('click_publish_notice', '系统通知');
    window.location.href = 'tougao.html';
  });
  $('.detail .detail-content .get-peize').on('click', function (e) {
    e.preventDefault();
    window.stReportGlobal('click_award_top', '领取奖励');
    //window.errorTips('比赛正在进行中，获奖结果将于<br />8月1日公布，请大侠耐心<br />等候哦！(　ﾟ∀ﾟ) ﾉ♡');
  });
  $('.head-menu-search-input').on('blur', function (e) {
    console.log('blur');
    $('.head-menu-search').attr('focus', 'false');
  });
  $('.head-menu-search-input').on('click', function (e) {
    console.log('focus');
    $('.head-menu-search').attr('focus', 'true');
  });
})();
(function () {
  $('.J_menu-awardmenuBox').on('click', 'li', function () {
    var type = $(this).find('a').attr('data-work-type');
    //window.stReportGlobal('click_change','点击切换作品');
    $(this).addClass('menu-award-menu-on');
    $(this).siblings('li').removeClass('menu-award-menu-on');
    $('.J_award-puburankBox li').attr('data-work-type', type);

    var index = $(this).index();
    $('.J_menu-awardprizeBox li').removeClass('prize-on');
    $('.J_menu-awardprizeBox li').eq(index).addClass('prize-on');
  });
})();
(function () {
  var service = window.serviceFactory(window.XFERequest.jQueryRequest, Promise.reject.bind(Promise), '//test-ws.xoyo.com');
  var linkUrl = window.location.href;
  var pageSize = 100;
  linkUrl = linkUrl.split('.').join('');
  var getVideoList = function getVideoList(params) {
    /*本次大赛，daily提供视频源，官网统计点赞数，点赞数和视频源分开请求*/
    return new Promise(function ($return, $error) {
      $.ajax({
        url: '//test-ws.xoyo.com/core/jhdaily/cms_query',
        dataType: 'jsonp',
        type: 'POST',
        data: params,
        success: function success($data) {
          if ($data.status === 1) {
            $return($data);
          } else {
            window.errorTips($data.msg);
            $error($data.msg);
          }
        },
        error: function error(_error) {
          $error(_error.msg);
        }
      });
    });
  };
  var getLikeList = function getLikeList() {
    /*本次大赛，daily提供视频源，官网统计点赞数，点赞数和视频源分开请求*/
    return new Promise(function ($return, $error) {
      $.ajax({
        url: '//test-ws.xoyo.com/jx3/tongrenxs190515/get_like_list',
        dataType: 'jsonp',
        type: 'POST',
        success: function success($data) {
          if ($data.status === 1) {
            $return($data.data.work_like_list);
          } else {
            window.errorTips($data.msg);
            $error($data.msg);
          }
        },
        error: function error(_error2) {
          $error(_error2.msg);
        }
      });
    });
  };
  var initPubu = function initPubu(_ref) {
    var works_type = _ref.works_type,
        page_num = _ref.page_num,
        _ref$page_size = _ref.page_size,
        page_size = _ref$page_size === undefined ? pageSize : _ref$page_size,
        order_by = _ref.order_by,
        change = _ref.change,
        type = _ref.type;

    (function () {
      return new Promise(function ($return, $error) {
        var pageCallback, data, catCode, requestParams;

        if (type = 'index') {
          pageCallback = function pageCallback(page_index, jq) {
            return new Promise(function ($return, $error) {
              var requestParams;

              $('html,body').animate({ scrollTop: '710' }, 800);
              requestParams = {
                uri: '/webgw/article/search',
                params: JSON.stringify({
                  catCode: catCode,
                  //catId: '',
                  /*daily返回数据的页码是从0开始，分页器页码是从1开始，所以不用做+1处理*/
                  cursor: page_index * pageSize,
                  size: pageSize
                })

              };
              return Promise.resolve(getVideoList(requestParams)).then(function ($await_3) {
                try {
                  data = $await_3;
                  initPubuDom(data);
                  return $return();
                } catch ($boundEx) {
                  return $error($boundEx);
                }
              }, $error);
            });
          };

          data = '';

          catCode = '';
          if (works_type === 0) {
            catCode = "Web_Doujin_Match_Novel_Master_Articles";
          } else if (works_type === 1) {
            catCode = "Web_Doujin_Match_Novel_Famous_Articles";
          } else if (works_type === 2) {
            catCode = "Web_Doujin_Match_Novel_Sharp_Barb_Articles";
          } else if (works_type === 3) {
            catCode = "Web_Doujin_Match_Novel_Outstanding_Articles";
          } else if (works_type === 4) {
            catCode = "Web_Doujin_Match_Novel_All_Attention_Articles";
          } else {
            return $error(new Error('无法识别的选项卡标识！'));
          }
          requestParams = {
            uri: '/webgw/article/search',
            params: JSON.stringify({
              catCode: catCode,
              //catId: '',
              cursor: 0,
              size: pageSize,
              isRandom: change === 1 ? true : false
            })
          };
          return Promise.resolve(getVideoList(requestParams)).then(function ($await_4) {
            try {
              window.workListData = $await_4;

              if (change === 1) {}
              initPubuDom(workListData, 'list', order_by);

              if (change === 0) {
                /*没选中换一批，才进行分页*/
                $(".pagination").pagination(workListData.data.reply.total, {
                  "items_per_page": page_size,
                  "num_display_entries": 5,
                  "callback": pageCallback,
                  "num_edge_entries": 5,
                  "prev_text": "上一页",
                  "next_text": "下一页",
                  "prev_show_always": true,
                  "next_show_always": true
                });
              }

              return $If_1.call(this);
            } catch ($boundEx) {
              return $error($boundEx);
            }
          }.bind(this), $error);
        }

        function $If_1() {
          return $return();
        }

        return $If_1.call(this);
      });
    })();
  };
  var getSearchWorks = function getSearchWorks(params) {
    var requestParams = {
      uri: '/webgw/article/search',
      params: JSON.stringify({
        catCode: 'Web_Doujin_Match_Stage_Current_Articles',
        //catId: '',
        title: params.keyword,
        cursor: 0,
        size: pageSize
      })
    };
    return new Promise(function (resolve, reject) {
      $.ajax({
        url: '//test-ws.xoyo.com/core/jhdaily/cms_query',
        dataType: 'jsonp',
        type: 'POST',
        data: requestParams,
        success: function success($data) {
          if ($data.status === 1) {
            resolve($data);
          } else {
            window.errorTips($data.msg);
            reject($data.msg);
          }
        },
        error: function error(_error3) {
          reject(_error3.msg);
        }
      });
    });
  };
  var initSearch = function initSearch(_ref2) {
    var order_by = _ref2.order_by,
        page_num = _ref2.page_num,
        _ref2$page_size = _ref2.page_size,
        page_size = _ref2$page_size === undefined ? pageSize : _ref2$page_size,
        keyword = _ref2.keyword;

    (function () {
      return new Promise(function ($return, $error) {
        var _$$pagination, pageCallback, data;

        if ($.trim(keyword) !== '') {
          pageCallback = function pageCallback(page_index, jq) {
            return new Promise(function ($return, $error) {
              var requestParams, searchData;

              $('html,body').animate({ scrollTop: '710' }, 800);
              requestParams = {
                uri: '/webgw/article/search',
                params: JSON.stringify({
                  catCode: 'Web_Doujin_Match_Stage_Current_Articles',
                  //catId: '',
                  /*daily返回数据的页码是从0开始，分页器页码是从1开始，所以不用做+1处理*/
                  cursor: page_index * pageSize,
                  size: pageSize
                })

              };
              return Promise.resolve(getVideoList(requestParams)).then(function ($await_5) {
                try {
                  searchData = $await_5;
                  initPubuDom(searchData);
                  return $return();
                } catch ($boundEx) {
                  return $error($boundEx);
                }
              }, $error);
            });
          };

          return Promise.resolve(getSearchWorks({
            order_by: order_by,
            page_num: page_num,
            page_size: page_size,
            keyword: keyword
          })).then(function ($await_6) {
            try {
              data = $await_6;
              initPubuDom(data, 'search');

              $(".pagination").pagination(data.data.reply.total, (_$$pagination = {
                "items_per_page": 9,
                "num_display_entries": 5,
                "callback": pageCallback,
                "num_edge_entries": 5,
                "prev_text": "上一页",
                "next_text": "下一页",
                "prev_show_always": true
              }, _$$pagination['prev_show_always'] = true, _$$pagination["next_show_always"] = true, _$$pagination));
              return $If_2.call(this);
            } catch ($boundEx) {
              return $error($boundEx);
            }
          }.bind(this), $error);
        } else {
          window.errorTips('请输入搜索关键词~');
          return $If_2.call(this);
        }

        function $If_2() {
          $('.J_award-pubusearchTxt').html(keyword);
          return $return();
        }
      });
    })();
  };

  if (linkUrl.lastIndexOf('searchhtml') > -1) {//如果是搜索页，则不初始化数据

  } else {
    //初始化首页数据
    initPubu({
      works_type: 0, //1服饰 2日用家居 3文创用品 4手办模具 5毛绒公仔 6箱包收纳 7首饰类 8宠物类 9其他类
      page_num: 1, //page_num
      page_size: pageSize, //每页显示条数
      order_by: 2, //1时间 2人气
      change: 0, //1是 2否
      type: 'index'
    });
  }

  //渲染瀑布流
  function initPubuDom($data) {
    var $args = arguments;return new Promise(function ($return, $error) {
      var type, order_by, likeList, targetArr, html, dataLoop;
      type = $args.length > 1 && $args[1] !== undefined ? $args[1] : 'list';
      order_by = $args[2];
      return Promise.resolve(getLikeList()).then(function ($await_7) {
        try {
          likeList = $await_7;
          targetArr = $data.data.reply.data;
          targetArr.forEach(function (item, index) {
            /*本次大赛，daily提供视频源，官网统计点赞数,两边拉取数据后需要做整合*/
            if (likeList[item.id]) {
              item.gwLike = likeList[item.id].count;
            } else {
              item.gwLike = 0;
            }
          });
          if (order_by === 2) {
            targetArr.sort(function (A, B) {
              return B.gwLike - A.gwLike;
            });
          }
          if (parseInt($data.data.reply.total) > 0) {
            html = '', dataLoop = '';
            if (type === 'search') {
              $('.J_award-puburankSearch').show();
              dataLoop = $data.data.reply.data;
              $('.J_award-pubusearchNum').empty().html(dataLoop.length);
            } else {
              dataLoop = $data.data.reply.data;
            }
            $.each(dataLoop, function (i, object) {
              html += '<div class="video-item-root">\n            <div class="video-item-group-1" data-name="1">\n            <div class="video-cover J_showDetailWork" data-work-id="' + object.id + '">\n              <div class="hover-cover"></div>\n              <a href="detail.html?id=' + object.id + '" target="_blank"><img class="video-item-layer-1 J_showDetailWork" data-work-id="' + object.id + '" src="' + object.thumb + '" data-name="013241"/></a>\n              <div class="video-item-layer-2 J_showDetailWork" data-work-id="' + object.id + '" data-name="\u64AD\u653E\u6309\u94AE"></div>\n            </div>\n            <div class="video-item-group-2" data-name="\u6587\u5B57\u7EC4">\n            <div class="video-item-layer-3" data-name="bg"></div>\n            <div class="video-item-group-3" data-name="\u70B9\u8D5E">\n            <div class="video-item-layer-4" data-name="1,231,243">' + object.gwLike + '</div>\n            <div class="video-item-layer-5 J_addLikeBtn" data-work-id="' + object.id + '" data-name="\u70B9\u8D5E (2)"></div>\n            </div>\n            <div class="video-item-layer-6" data-name="\u5206\u5272\u7EBF"></div>\n            <img class="video-item-layer-7" data-name="\u5934\u50CF" src="' + (object.avatarUrl !== '' ? object.avatarUrl : '') + '"/>\n            <div class="video-item-layer-8" data-name="\u4F5C\u54C1\u540D\u6700\u957F\u663E\u793A\u4E8C\u5341\u4E2A\u5B57\u591A\u7684\u8BDD\u5C31\u7701\u7565\u54AF\u77E5\u9053...">' + object.title + '</div>\n            <div class="video-item-layer-9" data-name="\u4F5C\u8005\u540D\u5B57\u6700\u957F8\u5B57...">' + object.userNickname + '</div>\n            <div class="video-item-layer-10" data-name="\u52A9\u624BID\uFF1A459808599">\u52A9\u624BID\uFF1A' + object.personNum + '</div>\n            </div>\n            </div>\n            </div>';
            });
            $(".item-list").empty().append(html);
            //$.pub.masonry_start();
          } else {
            if (type === 'search') {
              $('.J_award-puburankSearch').hide();
              $(".item-list").empty().html('<div class="award-pubu-search-nodata J_award-pubusearchNoData" style="display: block;">\n                                          <img src="assets/images/no-result.png" alt="\u6682\u65E0\u6570\u636E">\n                                        </div>');
            } else {
              window.errorTips('暂无作品');
            }
          }
          return $return();
        } catch ($boundEx) {
          return $error($boundEx);
        }
      }, $error);
    });
  };

  //首页选项卡菜单 点击
  $('.J_menu-awardmenuBox').on('click', '.J_menu-awardchangeTags', function () {
    var works_type = parseInt($(this).attr('data-work-type'));
    $('.J_award-puburankBox li').removeClass('award-pubu-rank-cur');
    $('.J_award-puburankBox li').eq(0).addClass('award-pubu-rank-cur');
    if (works_type === 1) {
      $(".index-pubu-rank-box.inList").hide();
    } else {
      $(".index-pubu-rank-box.inList").show();
    }
    initPubu({
      works_type: works_type, //1服饰 2日用家居 3文创用品 4手办模具 5毛绒公仔 6箱包收纳 7首饰类 8宠物类 9其他类
      page_num: 1, //page_num
      page_size: pageSize, //每页显示条数
      order_by: 2, //1时间 2人气
      change: 0, //1是 2否
      type: 'index'
    });
  });

  //首页最新 人气 换一批 点击
  $('.J_award-puburankBox li').on('click', function () {
    var works_type = parseInt($(this).attr('data-work-type'));
    var order_by = parseInt($(this).attr('data-order-by'));
    var change = parseInt($(this).attr('data-change'));
    $(this).addClass('award-pubu-rank-cur');
    $(this).siblings('li').removeClass('award-pubu-rank-cur');
    initPubu({
      works_type: works_type, //1服饰 2日用家居 3文创用品 4手办模具 5毛绒公仔 6箱包收纳 7首饰类 8宠物类 9其他类
      page_num: 1, //page_num
      page_size: pageSize, //每页显示条数
      order_by: order_by, //1时间 2人气
      change: change, //1是 2否
      type: 'index'
    });
  });

  /**
   * 搜索相关
   */
  var searchInfo = $.COMMETHOD.getUrlArgs('keywords') ? $.COMMETHOD.getUrlArgs('keywords') : null;
  /**
   * 如果检测到 顶部有搜索参数 那么就先初始化一次 数据
   */
  if (searchInfo) {
    $('.J_award-puburankBox').hide();
    $('.J_menuTopBox').hide();
    $('.J_award-puburankSearch, .J_award-pubusearchNav').show();
    initSearch({
      order_by: 1,
      page_num: 1,
      page_size: pageSize,
      keyword: searchInfo
    });
  }

  $('.J_searchInfoBtn').on('click', function () {
    var keyword = $(this).siblings('.J_searchInfoText').val();
    var searchType = $(this).attr('data-type'); //判断是顶部搜索按钮 还是 首页中间的按钮
    if (!keyword) {
      window.errorTips('请输入搜索内容');
    }
    window.scrollTo(0, 717);

    if (searchType === 'searchTop') {
      window.stReportGlobal('click_search', '点击搜索', keyword);
    } else {
      window.stReportGlobal('input_search_main', '主体搜索', keyword);
    }
    /**
     * 如果是搜索页 那么就不刷新 否则跳转到搜索结果页
     */
    if (linkUrl.lastIndexOf('searchhtml') > -1) {
      initSearch({
        order_by: 1,
        page_num: 1,
        page_size: 90,
        keyword: keyword
      });
    } else {
      window.location.href = 'search.html?keywords=' + keyword + '#searchtop';
    }
  });
  /**
   * search 人气和时间排序事件
   */
  $('.J_award-puburankBoxSearch li').on('click', function () {
    var order_by = $(this).attr('data-order-by'),
        keyword = $('.J_award-pubusearchTxt').html();
    $(this).siblings('li').removeClass('award-pubu-rank-cur');
    $(this).addClass('award-pubu-rank-cur');
    initSearch({
      order_by: order_by,
      page_num: 1,
      page_size: pageSize,
      keyword: keyword
    });
  });
})();
(function () {
  window.onload = function () {
    var pageLoadComplete = +new Date();
    var timeStamp = pageLoadComplete - window.pageLoadBegin;
    //window.stReportWithTimeStamp('load_page_works', '加载作品页', timeStamp);
  };
})();

(function () {
  likeCallBack = function likeCallBack(id) {
    /*点赞后对缓存的数组进行处理*/
    var target = window.workListSortByLike.find(function (item) {
      if (item.id === id) {
        item.gwLike += 1;
        debugger;
        workListSortByLike.sort(function (A, B) {
          return B.gwLike - A.gwLike;
        });
      }
    });
  };
  //点赞
  var service = window.serviceFactory(window.XFERequest.jQueryRequest, Promise.reject.bind(Promise), '//test-ws.xoyo.com'),
      detailShareId = $.COMMETHOD.getUrlArgs('shareid') ? $.COMMETHOD.getUrlArgs('shareid') : null;
  $(document).on('click', '.J_addLikeBtn', function () {
    var works_id = $(this).attr('data-work-id');
    var that = $(this);
    window.stReportGlobal('click_like', '作品点赞');
    var like = function like(param) {
      /*点赞*/
      return new Promise(function (resolve, reject) {
        $.ajax({
          url: '//test-ws.xoyo.com/jx3/tongrenxs190515/like',
          dataType: 'jsonp',
          type: 'POST',
          data: {
            works_id: param.works_id
          },
          success: function success($data) {
            if ($data.code === 1) {
              resolve($data);
            } else if ($data.code === -10402) {
              window.XPASS.signin();
            } else if ($data.code === -20103) {
              window.errorTips('您的点赞次数已用完<br/>前往剑网3推栏 APP<br/>点赞机会再+1！');
            } else {
              window.errorTips($data.msg);
              reject($data.msg);
            }
          },
          error: function error(_error) {
            reject(_error.msg);
          }
        });
      });
    };
    (function () {
      return new Promise(function ($return, $error) {
        var data;
        return Promise.resolve(like({
          works_id: works_id,
          type: 'PC'
        })).then(function ($await_1) {
          try {
            data = $await_1;
            if (data) {
              if (that.hasClass('detail-pop-btn')) {
                //如果是内容页的点赞
                $('.J_detail-poplikeBtnWrap').addClass('tada animated item-support-ok');
                setTimeout(function () {
                  $('.J_detail-poplikeBtnWrap').removeClass('tada animated');
                }, 1000);
                /*const id = that.attr('data-work-id');
                likeCallBack(id);*/
                $('.J_detail-poplikeNum').html(parseInt($('.J_detail-poplikeNum').html()) + 1);
              } else {
                that.addClass('tada animated item-support-ok');
                setTimeout(function () {
                  that.removeClass('tada animated');
                }, 1000);
                /*const id = that.attr('data-work-id');
                likeCallBack(id);*/
                that.siblings().html(parseInt(that.siblings().html()) + 1);
              }
            }
            return $return();
          } catch ($boundEx) {
            return $error($boundEx);
          }
        }, $error);
      });
    })();
  });
  /*根据id查询作品数据*/
  var getWorksById = function getWorksById(params) {
    var requestParams = {
      uri: '/webgw/article/detail',
      params: JSON.stringify({
        articleId: params.works_id,
        //catId: '',
        commentSize: 0,
        hotCommentSize: 1
      })
    };
    return new Promise(function (resolve, reject) {
      $.ajax({
        url: '//test-ws.xoyo.com/core/jhdaily/cms_query',
        dataType: 'jsonp',
        type: 'POST',
        data: requestParams,
        success: function success($data) {
          if ($data.status === 1) {
            resolve($data);
          } else {
            window.errorTips($data.msg);
            reject($data.msg);
          }
        },
        error: function error(_error2) {
          reject(_error2.msg);
        }
      });
    });
  };

  /*根据id查询作品点赞数*/
  var getLikeById = function getLikeById(params) {
    return new Promise(function ($return, $error) {
      $.ajax({
        url: '//test-ws.xoyo.com/jx3/tongrenxs190515/get_count_by_id',
        dataType: 'jsonp',
        type: 'POST',
        data: {
          works_id: params.works_id
        },
        success: function success($data) {
          if ($data.status === 1) {
            $return($data.data.count);
          } else {
            window.errorTips($data.msg);
            $error($data.msg);
          }
        },
        error: function error(_error3) {
          $error(_error3.msg);
        }
      });
    });
  };
  /*拉取随机作品列表数据*/
  getRandomVideoList = function getRandomVideoList(params) {
    /*本次大赛，daily提供视频源，官网统计点赞数，点赞数和视频源分开请求*/
    return new Promise(function ($return, $error) {
      $.ajax({
        url: '//test-ws.xoyo.com/core/jhdaily/cms_query',
        dataType: 'jsonp',
        type: 'POST',
        data: params,
        success: function success($data) {
          if ($data.status === 1) {
            $return($data);
          } else {
            window.errorTips($data.msg);
            $error($data.msg);
          }
        },
        error: function error(_error4) {
          $error(_error4.msg);
        }
      });
    });
  };
  /*拉取点赞数列表*/
  var getLikeList = function getLikeList() {
    /*本次大赛，daily提供视频源，官网统计点赞数，点赞数和视频源分开请求*/
    return new Promise(function ($return, $error) {
      $.ajax({
        url: '//test-ws.xoyo.com/jx3/tongrenxs190515/get_like_list',
        dataType: 'jsonp',
        type: 'POST',
        success: function success($data) {
          if ($data.status === 1) {
            $return($data.data.work_like_list);
          } else {
            window.errorTips($data.msg);
            $error($data.msg);
          }
        },
        error: function error(_error5) {
          $error(_error5.msg);
        }
      });
    });
  };
  //渲染内容页内容
  var showDetail = function showDetail(_ref) {
    var works_id = _ref.works_id;

    var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
    //$('.J_detail-poppopInfo').css('top', scrollTop);
    $('.J_detail-poppopInfo, .J_detail-popmask').fadeIn();

    function loadImage(src) {
      return new Promise(function (resolve, reject) {
        var image = new Image();
        image.onload = resolve;
        image.onerror = reject;
        image.src = src;
      });
    }

    (function () {
      return new Promise(function ($return, $error) {
        var data, likeCount, requestParams, randomList, likeList, html, htmlUser, itemUser, hotComment, getShareArgs, activeTagType, weixinShareUrl, isShowWeixin, quality;
        return Promise.resolve(getWorksById({
          works_id: works_id
        })).then(function ($await_2) {
          try {
            data = $await_2;
            return Promise.resolve(getLikeById({
              works_id: works_id
            })).then(function ($await_3) {
              try {
                likeCount = $await_3;
                data.data.reply.gwLike = likeCount;
                requestParams = {
                  uri: '/webgw/article/search',
                  params: JSON.stringify({
                    catCode: 'Web_Doujin_Match_Novel_Current_Articles',
                    //catId: '',
                    cursor: 0,
                    size: 4,
                    isRandom: true
                  })
                };
                return Promise.resolve(getRandomVideoList(requestParams)).then(function ($await_4) {
                  try {
                    randomList = $await_4.data.reply.data;
                    return Promise.resolve(getLikeList()).then(function ($await_5) {
                      try {
                        likeList = $await_5;
                        randomList.forEach(function (item, index) {
                          if (likeList[item.id]) {
                            item.gwLike = likeList[item.id].count;
                          } else {
                            item.gwLike = 0;
                          }
                          $('.recommend-works-item.item-' + (index + 1)).attr('data-work-id', item.id);
                          $('.recommend-works-item.item-' + (index + 1) + ' div').css('background', 'url(' + item.thumb + ')');
                          $('.recommend-works-item.item-' + (index + 1) + ' div').css('background-size', '100% 100%');
                          $('.recommend-works-item.item-' + (index + 1) + ' p span.title').html(item.title);
                          $('.recommend-works-item.item-' + (index + 1) + ' p span.author-name').html(item.userNickname);
                          $('.recommend-works-item.item-' + (index + 1) + ' p span.like span.value').text(item.gwLike);
                          $('.recommend-works-item.item-' + (index + 1)).show();
                        });
                        if (data) {
                          html = '', htmlUser = '', itemUser = data.data.reply;
                          //$.each(data.works_list, function (i, item) {
                          html += '<img class="swiper-lazy" src="' + itemUser.thumb + '" alt="' + itemUser.name + '" />';
                          //});
                          htmlUser = ' <h2 class="detail-pop-tit">' + itemUser.title + '</h2>\n                            <p class="detail-pop-time">' + itemUser.createTime + '</p>\n                            <div class="detail-pop-avatar-box">\n                              <div class="detail-pop-avatar">\n                                <img src="' + itemUser.avatarUrl + '" alt="">\n                              </div>\n                              <div class="detail-pop-name">\n                                <p class="detail-pop-name-txt">' + itemUser.userNickname + '</p>\n                                <p class="detail-pop-time">\u52A9\u624BID\uFF1A' + itemUser.personNum + '</p>\n                              </div>\n                              <div class="detail-pop-check-author J_detail-popDaily-author-Btn"></div>\n                            </div>\n                            <div class="detail-pop-btn-box">\n                              <div class="detail-pop-btn J_addLikeBtn" data-like-type="detail" data-work-id="' + itemUser.id + '" style="display: none;">\n                              <span class="J_detail-poplikeBtnWrap">\n                                <strong>\u8D5E</strong>\n                                <strong>(<em class="J_detail-poplikeNum">' + itemUser.gwLike + '</em>)</strong>\n                              </span>\n                              </div>\n                            </div>';
                          $('.video-box').html(html);
                          $('.J_detail-popuserInfo').empty().html(htmlUser); //内容页右侧内容
                          if (itemUser.hotComments.length > 0) {
                            hotComment = itemUser.hotComments[0];
                            $('.J_detail-popdetailIdea .hot-comment-content').html(hotComment.comment);
                            $('.J_detail-popdetailIdea .hot-comment-author .avatar').attr('src', hotComment.avatarUrl);
                            $('.J_detail-popdetailIdea .hot-comment-author .name').html(hotComment.nickname);
                            if (hotComment.roleName.length > 0) {
                              $('.J_detail-popdetailIdea .hot-comment-author .role-name').html(hotComment.roleName);
                            } else {
                              $('.J_detail-popdetailIdea .hot-comment-author .role-name').html('暂无角色信息');
                            }

                            $('.J_detail-popdetailIdea .hot-comment-author .server').html(hotComment.server);
                            $('.J_detail-popdetailIdea .hot-comment-author .school').html(hotComment.school);
                          } else {
                            $('.J_detail-popdetailIdea .hot-comment-content').html('暂无热评~');
                            $('.J_detail-popdetailIdea .hot-comment-author').hide();
                          }
                          $('.J_detail-popreportLink').attr('href', 'report.html?id=' + itemUser.id + '&title=' + itemUser.name);
                          getShareArgs = function getShareArgs(type) {
                            switch (type) {
                              case 'QQ':
                                var component = '';
                                component += 'url=' + (encodeURIComponent('https://jx3.xoyo.com/zt/2019/05/27/tongren-novel/detail.html?id=') + itemUser.id);
                                component += '&title=' + encodeURIComponent('江湖入话！首届剑网3同人嘉年华小说大赛开启啦！');
                                component += '&desc=' + encodeURIComponent('江湖入话，杯酒盏茶。首届剑网3同人嘉年华剑网3推栏小说大赛开始啦！诚邀各路大侠参与征集，百万现金奖池、重制版同人嘉年华定制特效挂件、重制版专属称号、官方小说套装大礼包、剑网3十周年线下庆典嘉宾资格等你拿！');
                                component += '&summary=';
                                component += '&site=';
                                component += '&pics=http://jx3.xoyo.com/zt/2019/05/27/tongren-novel-share-pc.jpg';
                                return component;

                              case 'WEIBO':
                                var _component = '';
                                _component += 'url=' + (encodeURIComponent('https://jx3.xoyo.com/zt/2019/05/27/tongren-novel/detail.html?id=') + itemUser.id);
                                _component += '&title=' + encodeURIComponent('江湖入话，杯酒盏茶。首届剑网3同人嘉年华#剑网3推栏小说大赛#开始啦！诚邀各路大侠参与征集，百万现金奖池、重制版同人嘉年华定制特效挂件、重制版专属称号、官方小说套装大礼包、剑网3十周年线下庆典嘉宾资格等你拿！获奖作品将有机会加入官方共创计划，还可获得西山居offer哦！');
                                _component += '&appkey=';
                                _component += '&pic=http://jx3.xoyo.com/zt/2019/05/27/tongren-novel-share-pc.jpg';
                                _component += '&searchPic=true#_loginLayer_1556245391157';
                                return _component;

                            }
                          };
                          $('.J_shareQqLink').attr('href', 'https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?' + getShareArgs('QQ'));
                          $('.J_shareWeiboLink').attr('href', 'http://service.weibo.com/share/share.php?' + getShareArgs('WEIBO'));
                          activeTagType = $('.menu-index-menu-on').attr('data-work-type');
                          weixinShareUrl = '';
                          if (activeTagType === '0') {
                            weixinShareUrl = 'https://test-zt.xoyo.com/jx3.xoyo.com/m/2019/05/27/tongren-novel/index.html?utm_source=gw#/details/' + itemUser.id;
                          } else if (activeTagType === '1') {
                            weixinShareUrl = 'https://test-zt.xoyo.com/jx3.xoyo.com/m/2019/05/27/tongren-novel/index.html?utm_source=gw#/details/' + itemUser.id;
                          } else {
                            /*首页没有选项卡作为参考，*/
                            weixinShareUrl = 'https://jx3.xoyo.com/m/2019/05/27/tongren-novel/index.html?utm_source=gw#/details/' + itemUser.id;
                          }
                          //微信二维码弹出窗
                          isShowWeixin = true;
                          $('.J_detail-popweixinBtn').on('click', function () {
                            $('.J_detail-popweixinBox').show();
                            $(".J_detail-popweixin").empty();
                            $(".J_detail-popweixin").qrcode({
                              render: "canvas",
                              width: 205,
                              height: 205,
                              correctLevel: 0,

                              text: weixinShareUrl
                              //text: 'http://s.xoyo.com/P9mBM'
                            });
                          });
                          $('.J_detail-popweixinClose').on('click', function () {
                            $('.J_detail-popweixinBox').hide();
                          });
                          //daily二维码弹出
                          $('.J_detail-popDailyBtn').on('click', function () {
                            $('.J_detail-popDailyBox').show();
                            $(".J_detail-popDaily").empty();
                          });
                          $('.J_detail-popDailyClose').on('click', function () {
                            $('.J_detail-popDailyBox').hide();
                          });

                          //举报二维码弹出
                          $('.J_detail-popJubaoBtn').on('click', function () {
                            $('.J_detail-popJubaoBox').show();
                            $(".J_detail-popJubao").empty();
                          });
                          $('.J_detail-popJubaoClose').on('click', function () {
                            $('.J_detail-popJubaoBox').hide();
                          });
                          //daily作者搜索引导弹出
                          $('.J_detail-popDaily-author-Btn').on('click', function () {
                            $('.J_detail-popDaily-authorBox').show();
                            $(".J_detail-popDaily-author").empty();
                          });
                          $('.J_detail-popDaily-authorClose').on('click', function () {
                            $('.J_detail-popDaily-authorBox').hide();
                          });

                          $('.J_swiperList').empty().html(html);
                          /*初始化视频*/
                          quality = [];
                          /*if (itemUser.video && typeof itemUser.video === 'object') {
                            if (itemUser.video.resolutionInfoes.length > 0) {
                              itemUser.video.resolutionInfoes.forEach((val, index) => {
                                const {type, url} = val;
                                let videoType = {
                                  name: type,
                                  url: `https://wvcdn.pvp.xoyo.com/${url}`,
                                  type: 'hls'
                                };
                                quality.push(videoType);
                              });
                              window.pageDplayVideo = new DPlayer({
                                container: document.getElementById('video-content'),
                                video: {
                                  quality: quality,
                                  defaultQuality: 0,
                                  //pic: screenShot,
                                  autoplay: true
                                }
                              });
                              pageDplayVideo.play();
                            } else {
                              window.errorTips('视频内容出错了~')
                            }
                          } else {
                            window.errorTips('视频内容出错了~')
                          }*/

                          $('.detail-pop-left').append($(itemUser.content));
                          //await loadImage(data.works_list[0].pic_link);
                          /*const swiper = new Swiper('.swiper-container', {
                            paginationClickable: true,
                            nextButton: '.swiper-button-next',
                            lazyLoading: true,
                            prevButton: '.swiper-button-prev',
                            autoHeight: true, //enable auto height
                          });*/
                        }

                        return $return();
                      } catch ($boundEx) {
                        return $error($boundEx);
                      }
                    }, $error);
                  } catch ($boundEx) {
                    return $error($boundEx);
                  }
                }, $error);
              } catch ($boundEx) {
                return $error($boundEx);
              }
            }, $error);
          } catch ($boundEx) {
            return $error($boundEx);
          }
        }, $error);
      });
    })();
  };

  //如果是分享过来的，并且URL带了ID，那么渲染弹出窗，显示内容
  if (detailShareId) {
    $('.J_detail-poppopInfo, .J_detail-popmask').fadeIn();
    showDetail({ works_id: detailShareId });
  }

  //显示内容页
  if (window.location.href.lastIndexOf('detail.html') > -1) {
    var works_id = getUrlParameter('id');
    showDetail({ works_id: works_id });
  }
  $(document).on('click', '.J_showDetailWork', function () {
    var works_id = $(this).attr('data-work-id');
    //window.open('detail.html?id=' + works_id);
  });

  $(document).on('click', '.J_globalClickTrack', function () {
    var trackName = $(this).attr('data-tongji-name');
    var trackDesc = $(this).attr('data-tongji-desc');
    window.stReportGlobal(trackName, trackDesc);
  });

  $(document).on('click', '.ClickTrackWithWorkName', function () {
    var trackName = $(this).attr('data-tongji-name');
    var trackDesc = $(this).attr('data-tongji-desc');
    var workName = $(this).attr('data-work-name');
    window.stReportWithName(trackName, trackDesc, workName);
  });
})();</script>

</body>
</html>
