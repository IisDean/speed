<!doctype html>
<html lang="zh-cn">

<head>
    <meta charset="gbk">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
    <!-- 让添加到主屏幕的网页再次打开时全屏展示，可添加：   -->
    <meta content="yes" name="mobile-web-app-capable">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="robots" content="all">
    <meta name="author" content="Tencent-CP" />
    <meta name="Copyright" content="Tencent" />
    <meta name="Description" content="龙族幻想K歌分享">
    <meta name="Keywords"
        content="龙族幻想,龙族幻想官网,龙族幻想预约,腾讯龙族幻想官网,龙族幻想下载,虚幻4,龙族幻想官方网站,龙族幻想手游,腾讯龙族幻想,腾讯龙族幻想手游,腾讯龙族幻想下载,代号夏娃,代号夏娃下载,代号夏娃官网,腾讯代号夏娃">
    <title>龙族幻想K歌分享-龙族幻想-腾讯游戏</title>
    <link rel="stylesheet" href="//ossweb-img.qq.com/images/js/swiper/swiper-4.3.3.min.css">
    <link rel="stylesheet" href="//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/css/index.css">
    <script type='text/javascript' src='//pub.idqqimg.com/qqmobile/qqapi.js?_bid=152'></script>
    <script>
        //屏幕适应
        (function (win, doc) {
            if (!win.addEventListener) return;
            var html = document.documentElement;

            function setFont() {
                var html = document.documentElement;
                var k = 750;
                html.style.fontSize = html.clientWidth / k * 100 + "px";
            }
            setFont();
            setTimeout(function () {
                setFont();
            }, 300);
            doc.addEventListener('DOMContentLoaded', setFont, false);
            win.addEventListener('resize', setFont, false);
            win.addEventListener('load', setFont, false);
        })(window, document);
    </script>
</head>

<body>
    <div class="wrapper">
        <h1 class="hide">K歌分享</h1>
        <header class="head">
            <div class="flex topbar-wrap flex-between">
                <div class="full-img logo-wrap">
                    <img src="//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/logo.png" alt="龙族幻想">
                </div>
                <a href="https://dna.qq.com/m/m201812/main.shtml" class="ui-icon download-btn"
                    ontouchend="PTTSendClick('btn','guanwang','进入官网')"></a>
            </div>
            <div class="pr bg video-wrap">
                <video src="#" id="video" autoplay="autoplay"></video>
                <div class="absolute pointer-container">
                    <div class="swiper-container pointer-swiper">
                        <div class="swiper-wrapper">
                            <!-- 此处放置用户上传封面图片 -->
                            <div class="swiper-slide"
                                style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/video_bg.jpg');">
                            </div>
                            <div class="swiper-slide"
                                style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/pop_bg_2.png');">
                            </div>
                            <div class="swiper-slide"
                                style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/song_default.jpg');">
                            </div>
                            <div class="swiper-slide"
                                style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/song_bg.png');">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="absolute danmu-wrap"></div>
                <div class="absolute ui-icon play-btn"></div>
            </div>
            <div class="bg user-plank-wrap flex">
                <div class="user-head">
                    <div style="background-image: url('#')"></div>
                </div>
                <div class="flex-1 user-name-wrap">
                    <p class="user-name-text text-hide">可米莉亚</p>
                    <p class="qufu-text">微信3区</p>
                </div>
                <div class="user-msg-wrap">
                    <div class="flex data-wrap">
                        <i class="ui-icon play-num-icon"></i>
                        <span style="margin-right: .36rem;">5800</span>
                        <i class="ui-icon comment-num-icon"></i>
                        <span>1.3万</span>
                    </div>
                    <div class="flex data-wrap2">
                        <span>当前得票：</span>
                        <span class="number-text">2252</span>
                        <span style="margin-left: .34rem;">排名：</span>
                        <span class="number-text">23</span>
                    </div>
                </div>
            </div>
        </header>
        <section>
            <div class="bg vote-wrap">
                <p class="vote-tips-text text-center">老铁，还差<span>2</span>票就超过上一名了，考验友情的时候到了！</p>
                <div class="vote-btn-container flex">
                    <a href="javascript: ;" class="ui-icon vote-btn t"
                        ontouchend="PTTSendClick('btn','vote','我要支持TA')">我要支持TA</a>
                    <!--                <a href="javascript: ;" class="ui-icon get-vote-btn t" ontouchend="PTTSendClick('btn','get-vote','领取投票券')">领取投票券</a>-->
                </div>
                <p class="text-center vote-tips-text">预计增加<span>20/100</span>票</p>
            </div>
            <!-- tab切换 -->
            <div id="tabCut" class="tab-wrap">
                <div class="hd">
                    <ul class="flex tab-btn-wrap">
                        <li class="ui-icon flex-1 tab-btn on t">金曲榜</li>
                        <li class="ui-icon flex-1 tab-btn t">贡献榜</li>
                    </ul>
                </div>
                <div class="bd">
                    <div class="tab-panel" style="display: block;">
                        <ul class="song-list rank-list first flex">
                            <li class="pr song-item rank-item">
                                <div class="song-wrap">
                                    <div class="bg song-head"
                                        style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/song_default.jpg')">
                                    </div>
                                    <div class="absolute ui-icon ticket-wrap text-center">9999票</div>
                                    <div class="absolute ui-icon rank-num">1</div>
                                    <div class="pr text-hide text-center song-name-wrap">歌曲名字七个字</div>
                                </div>
                                <p class="text-hide text-center user-name2-text">玩家名字七个字</p>
                            </li>
                            <li class="pr song-item rank-item">
                                <div class="song-wrap">
                                    <div class="bg song-head"
                                        style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/song_default.jpg')">
                                    </div>
                                    <div class="absolute ui-icon ticket-wrap text-center">9999票</div>
                                    <div class="absolute ui-icon rank-num">2</div>
                                    <div class="pr text-hide text-center song-name-wrap">歌曲名字七个字</div>
                                </div>
                                <p class="text-hide text-center user-name2-text">玩家名字七个字</p>
                            </li>
                            <li class="pr song-item rank-item">
                                <div class="song-wrap">
                                    <div class="bg song-head"
                                        style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/song_default.jpg')">
                                    </div>
                                    <div class="absolute ui-icon ticket-wrap text-center">9999票</div>
                                    <div class="absolute ui-icon rank-num">3</div>
                                    <div class="pr text-hide text-center song-name-wrap">歌曲名字七个字</div>
                                </div>
                                <p class="text-hide text-center user-name2-text">玩家名字七个字</p>
                            </li>
                            <li class="pr song-item rank-item">
                                <div class="song-wrap">
                                    <div class="bg song-head"
                                        style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/song_default.jpg')">
                                    </div>
                                    <div class="absolute ui-icon ticket-wrap text-center">9999票</div>
                                    <div class="absolute ui-icon rank-num">4</div>
                                    <div class="pr text-hide text-center song-name-wrap">歌曲名字七个字</div>
                                </div>
                                <p class="text-hide text-center user-name2-text">玩家名字七个字</p>
                            </li>
                            <li class="pr song-item rank-item">
                                <div class="song-wrap">
                                    <div class="bg song-head"
                                        style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/song_default.jpg')">
                                    </div>
                                    <div class="absolute ui-icon ticket-wrap text-center">9999票</div>
                                    <div class="pr text-hide text-center song-name-wrap">歌曲名字七个字</div>
                                </div>
                                <p class="text-hide text-center user-name2-text">玩家名字七个字</p>
                            </li>
                            <li class="pr song-item rank-item">
                                <div class="song-wrap">
                                    <div class="bg song-head"
                                        style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/song_default.jpg')">
                                    </div>
                                    <div class="absolute ui-icon ticket-wrap text-center">9999票</div>
                                    <div class="pr text-hide text-center song-name-wrap">歌曲名字七个字</div>
                                </div>
                                <p class="text-hide text-center user-name2-text">玩家名字七个字</p>
                            </li>
                        </ul>
                        <div class="page-list flex">
                            <a href="javascript: ;" class="page-item page-prev">
                                <</a> <span class="page-item page-btn active">1</span>
                                    <span class="page-item page-btn">2</span>
                                    <span class="page-item page-btn">3</span>
                                    <span class="page-item page-btn">4</span>
                                    <span class="page-item page-btn">5</span>
                                    <a href="javascript: ;" class="page-item page-next">></a>
                        </div>
                    </div>
                    <div class="tab-panel">
                        <!-- first类名为控制第一页的前三名 皇冠图标，切换至大于第2页时请删除 first 类名 -->
                        <ul class="ranking-list rank-list first">
                            <li class="ranking-item rank-item flex">
                                <div class="ui-icon rank-num">1</div>
                                <div class="rank-head">
                                    <div
                                        style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/user_default.png')">
                                    </div>
                                </div>
                                <p class="rank-name-text text-hide">玩家昵称七个字玩家昵称七个字玩家昵称七个字</p>
                                <i class="ui-icon ticket-icon"></i>
                                <span class="flex-1 rank-ticket-text">99999</span>
                            </li>
                            <li class="ranking-item rank-item flex">
                                <div class="ui-icon rank-num">2</div>
                                <div class="rank-head">
                                    <div
                                        style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/user_default.png')">
                                    </div>
                                </div>
                                <p class="rank-name-text text-hide">玩家昵称七个字玩家昵称七个字玩家昵称七个字</p>
                                <i class="ui-icon ticket-icon"></i>
                                <span class="flex-1 rank-ticket-text">99999</span>
                            </li>
                            <li class="ranking-item rank-item flex">
                                <div class="ui-icon rank-num">3</div>
                                <div class="rank-head">
                                    <div
                                        style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/user_default.png')">
                                    </div>
                                </div>
                                <p class="rank-name-text text-hide">玩家昵称七个字玩家昵称七个字玩家昵称七个字</p>
                                <i class="ui-icon ticket-icon"></i>
                                <span class="flex-1 rank-ticket-text">99999</span>
                            </li>
                            <li class="ranking-item rank-item flex">
                                <div class="ui-icon rank-num">4</div>
                                <div class="rank-head">
                                    <div
                                        style="background-image: url('//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/user_default.png')">
                                    </div>
                                </div>
                                <p class="rank-name-text text-hide">玩家昵称七个字玩家昵称七个字玩家昵称七个字</p>
                                <i class="ui-icon ticket-icon"></i>
                                <span class="flex-1 rank-ticket-text">99999</span>
                            </li>
                        </ul>
                        <div class="page-list flex">
                            <a href="javascript: ;" class="page-item page-prev">
                                <</a> <span class="page-item page-btn active">1</span>
                                    <span class="page-item page-btn">2</span>
                                    <span class="page-item page-btn">3</span>
                                    <span class="page-item page-btn">4</span>
                                    <span class="page-item page-btn">5</span>
                                    <a href="javascript: ;" class="page-item page-next">></a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 赛事规则 -->
            <div class="rule-title-icon">
                <img src="//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/rule_icon.png" alt="赛事规则">
            </div>
            <div class="pr">
                <div class="absolute bg inset-icon"></div>
            </div>
            <ul class="rule-list">
                <li class="rule-item">1、活动时间：2019年11月30日-2019年12月11日；</li>
                <li class="rule-item" style="margin-top: .1rem;">2、分享规则：游戏内玩家可将作品分享至平台并邀请好友支持，每份作品最多可接受十位玩家的页面支持；</li>
                <li class="rule-item" style="margin-top: .1rem;">
                    3、支持规则：游戏活跃用户方可点击“我要支持TA”按钮支持该作品，每位玩家仅可支持一份作品，若该玩家为活动开启后的新注册用户，可为所支持的作品涨100票，若非新注册用户，则仅可为所支持的作品涨20票。
                </li>
            </ul>
            <a href="javascript: alert('敬请期待！');" class="open-app" ontouchend="PTTSendClick('btn','open-app','打开龙族幻想')">
                <img src="//game.gtimg.cn/images/xiawa/cp/a20191025kgshare/foot_open_app.png" alt="打开龙族幻想">
            </a>
        </section>
    </div>

    <!-- 弹窗开始 -->
    <!-- 支持成功 已为好友增加20票 -->
    <div class="dialog bg pop pop-1" id="pop5" style="display: none">
        <div class="dia-con">
            <p class="pop-title-text flex-1" style="opacity: 0;">投票成功</p>
            <p class="pop-description-text text-center" style="margin-top: .24rem;line-height: .52rem;">
                恭喜支持成功，<br />已为好友增加20票</p>
            <a href="javascript: closeDialog();" class="ui-icon ok-btn t">好的</a>
        </div>
        <a class="ui-icon absolute close-btn t" href="javascript: closeDialog();" title="关闭弹窗">×</a>
    </div>
    <!-- 支持成功 已为好友增加100票 -->
    <div class="dialog bg pop pop-1" id="pop6" style="display: none">
        <div class="dia-con">
            <p class="pop-title-text flex-1" style="opacity: 0;">投票成功</p>
            <p class="pop-description-text text-center" style="margin-top: .24rem;line-height: .52rem;">
                恭喜支持成功，<br />已为好友增加100票</p>
            <a href="javascript: closeDialog();" class="ui-icon ok-btn t">好的</a>
        </div>
        <a class="ui-icon absolute close-btn t" href="javascript: closeDialog();" title="关闭弹窗">×</a>
    </div>
    <!-- 投票重复 -->
    <div class="dialog bg pop pop-1" id="pop7" style="display: none">
        <div class="dia-con">
            <p class="pop-title-text flex-1" style="opacity: 0;">投票成功</p>
            <p class="pop-description-text text-center" style="margin-top: .24rem;line-height: .52rem;">
                您已支持过该作品或其他作品，<br />无法重复支持哦！</p>
            <a href="javascript: closeDialog();" class="ui-icon ok-btn t">好的</a>
        </div>
        <a class="ui-icon absolute close-btn t" href="javascript: closeDialog();" title="关闭弹窗">×</a>
    </div>
    <!-- 选择登录方式 -->
    <div class="dialog bg pop pop-1" id="pop8" style="display: none">
        <div class="dia-con">
            <p class="pop-title-text flex-1">请选择登录方式</p>
            <div class="flex login-wrap flex-between">
                <a href="javascript: closeDialog();" class="login-icon full-img">
                    <img src="ossweb-img/wx.png" alt="qq">
                    <p class="text-center">微信登录</p>
                </a>
                <a href="javascript: closeDialog();" class="login-icon full-img">
                    <img src="ossweb-img/qq.png" alt="qq">
                    <p class="text-center">qq登录</p>
                </a>
            </div>
        </div>
        <a class="ui-icon absolute close-btn t" href="javascript: closeDialog();" title="关闭弹窗">×</a>
    </div>
    <!-- 绑定角色 -->
    <div class="dialog bg pop pop-3" id="pop9" style="display: none">
        <div class="dia-con">
            <p class="pop-title-text flex-1">绑定角色</p>
            <div class="form-wrap" style="margin-top: .3rem;">
                <div class="flex">
                    <label>平台：</label>
                    <select class="flex-1" id="channelContentId">
                        <option>请选择平台</option>
                    </select>
                </div>
            </div>
            <div class="form-wrap">
                <div class="flex">
                    <label>系统：</label>
                    <select class="flex-1" id="systemContentId">
                        <option>请选择平台</option>
                    </select>
                </div>
            </div>
            <div class="form-wrap">
                <div class="flex">
                    <label>大区：</label>
                    <select class="flex-1" id="areaContentId">
                        <option>请选择平台</option>
                    </select>
                </div>
            </div>
            <div class="form-wrap">
                <div class="flex">
                    <label>角色：</label>
                    <select class="flex-1" id="roleContentId">
                        <option>请选择平台</option>
                    </select>
                </div>
            </div>
            <a href="javascript:;" class="ui-icon confirm-btn t" id="myGiftMainBtn"
                ontouchend="PTTSendClick('btn','vote-confirm','提交')">提交</a>
        </div>
        <a class="ui-icon absolute close-btn t" href="javascript: closeDialog();" title="关闭弹窗">×</a>
    </div>
    <!-- 弹窗 End-->
    <!--wrapper End-->

    <!-- h5 js start -->
    <script type="text/javascript" src="//ossweb-img.qq.com/images/js/mobile_bundle/util/zepto.js"></script>
    <script src="//ossweb-img.qq.com/images/js/swiper4_component/js/swiper.min.js"></script>
    <script type="text/javascript" src="//ossweb-img.qq.com/images/js/mobile_bundle/milo.js"></script>
    <script type="text/javascript" src="//ossweb-img.qq.com/images/ams/atm/reporting.js"></script>
    <!-- h5 js end -->

    <!--
    <script src="//game.gtimg.cn/images/js/zepto/zepto.min.js"></script>
    <script src="//ossweb-img.qq.com/images/js/milo_bundle/milo.js"></script>
	-->
    <script src="//game.gtimg.cn/images/js/2018foot/foot.js"></script>
    <script src="//game.gtimg.cn/images/js/su/danMu.beta.min.js"></script>
    <script src="//ossweb-img.qq.com/images/js/TGMobileShare/TGMobileShare.min.js"></script>
    <script>
        //播放音频
        var video = document.getElementById('video'),
            $playBtn = $(".play-btn");
        $playBtn.on("click", function () {
            video.play();
            $playBtn.fadeOut(300);
        });
        video.play();
        $(video).on("click", function () {
            video.pause();
            $playBtn.fadeIn(300);
        });

        //封面图片切换
        var pointerSwiper = new Swiper('.pointer-swiper', {
            autoplay: true, //等同于以下设置
            effect: 'fade',
        });

        //榜单切换
        $("#tabCut .hd ul li").on("click", function () {
            var index = $(this).index();
            $(this).addClass('on').siblings('li').removeClass('on');
            $("#tabCut .bd .tab-panel").hide().eq(index).show();
        });

        //投票计数
        var ticketNum = 1;
        var maxTicketNum = parseInt($("#maxTicketNum").text());
        $(".count-btn-wrap .count-btn").on("click", function () {
            $(this).hasClass('count-subtract') ? ticketNum-- : ticketNum++;
            countTicket();
        });

        function countTicket() {
            maxTicketNum = parseInt($("#maxTicketNum").text());
            ticketNum < 1 ? ticketNum = 1 : ticketNum;
            ticketNum > maxTicketNum ? ticketNum = maxTicketNum : ticketNum;
            $("#ticketNum").text(ticketNum);
        }

        //投票 弹出弹窗
        $(".vote-btn").on("click", function () {
            $(this).addClass('vote-btn-filter');
            TGDialogS('pop5'); //支持20票
            //TGDialogS('pop6');//支持100票
            //TGDialogS('pop7');//已经支持过了
        });
        //投票确认
        $(".vote-confirm-btn").on("click", function () {
            var voteNum = parseInt($("#ticketNum").text()); //票数
            closeDialog();
            TGDialogS('pop5'); //支持20票
            //TGDialogS('pop6');//支持100票
            //TGDialogS('pop7');//已经支持过了
        });

        //领取投票券，弹窗弹窗
        $(".get-vote-btn").on("click", function () {
            TGDialogS('pop3');
        });
        //领取投票券
        $(".task-btn-2").on("click", function () {
            $(this).addClass("task-btn-3").removeClass('task-btn-2');
        });

        function TGDialogS(e) {
            // 利用milo库引入dialog组件
            need("biz.dialog", function (Dialog) {
                Dialog.show({
                    id: e,
                    bgcolor: '#000', //弹出“遮罩”的颜色，格式为"#FF6600"，可修改，默认为"#fff"
                    opacity: 50 //弹出“遮罩”的透明度，格式为｛10-100｝，可选
                });
            });
        }

        function closeDialog() {
            // 利用milo库引入dialog组件
            need("biz.dialog", function (Dialog) {
                Dialog.hide();
            });
        }

        //初始的弹幕数据
        var danmuData = [
            '11111',
            '222222222222',
            '3333333333',
            '4444444444',
            '5555555555',
            '666666666666',
            '777777777777',
        ];
        //实例化弹幕
        var dm = new danMu({
            device: 'm',
            stage: $(".danmu-wrap"),
            comments: danmuData,
            danMuHtml: "<span>{comment}</span>",
            colors: ["#fff", "#00ccff", "#ff0000", "#00ff00", "#fef500"],
            flyTime: 7000,
            timeInterval: 1200,
            randomSort: true
        });
        dm.play();

        window.getRandom = function (max, min) {
            return Math.floor(Math.random() * (max - min) + min);
        };
        //分享随机文案
        var shareText = [
            '这首歌也太太太特别了吧，讲真，记得把声音开小一点~1',
            '这首歌也太太太特别了吧，讲真，记得把声音开小一点~2',
            '这首歌也太太太特别了吧，讲真，记得把声音开小一点~3',
            '这首歌也太太太特别了吧，讲真，记得把声音开小一点~4',
            '这首歌也太太太特别了吧，讲真，记得把声音开小一点~5',
            '这首歌也太太太特别了吧，讲真，记得把声音开小一点~6'
        ];
        TGMobileShare({
            shareTitle: shareText[getRandom(0, shareText.length)], //不设置或设置为空时，页面有title，则调取title
            shareDesc: '可米莉亚', //不设置或设置为空时，页面有Description，则调取Description
            shareImgUrl: 'https://game.gtimg.cn/images/xiawa/cp/a20191025kgshare/share.jpg', //分享图片尺寸200*200，且填写绝对路径
            shareLink: '', //分享链接要跟当前页面同域名(手Q分享有这个要求) ,不设置或设置为空时，默认调取当前URL
            actName: 'a20191025kgshare' //点击流命名，用于统计分享量，专题一般采用目录名称如a20151029demo
        });

        /***** H5 start **********************/
        var ua = window.navigator.userAgent.toLowerCase()
        var UA = navigator.userAgent
        var REGEXP_IOS_QQ = /(iPad|iPhone|iPod).*? QQ\/([\d\.]+)/
        var REGEXP_ANDROID_QQ = /\bV1_AND_SQI?_([\d\.]+)(.*? QQ\/([\d\.]+))?/

        function isWeiXin() {
            if (ua.match(/MicroMessenger/i) == 'micromessenger') {
                return true
            } else {
                return false
            }
        }

        function isQQ() {
            var sUserAgent = navigator.userAgent
            var REGEXP_IOS_QQ = new RegExp('(iPad|iPhone|iPod).*? (IPad)?QQ\\/([\\d\\.]+)')
            var REGEXP_ANDROID_QQ = new RegExp('\\bV1_AND_SQI?_([\\d\\.]+)(.*? QQ\\/([\\d\\.]+))?', 'ig')

            var isIphoneOs_QQ = REGEXP_IOS_QQ.test(sUserAgent)
            var isAndroid_QQ = REGEXP_ANDROID_QQ.test(sUserAgent)

            if (isIphoneOs_QQ || isAndroid_QQ) {
                return true
            } else {
                return false
            }
        }

        function isIos() {
            return /iphone|ipod|ipad/i.test(ua)
        }

        function isAndroid() {
            return /android/i.test(ua)
        }

        var actLinkM = window.location.protocol + '//dna.qq.com/cp/a20191025kgshare/index_wq.html',
            _server_url = '',
            serviceType = 'xiawa',
            qqappid = '1106940691',
            wxappidM = 'wx1cd4fbe9335888fe',
            ams_targetappid = 'wxebffc92f0b100397'

        var sData = {},
            sArea = '',
            sPlatId = '',
            sPartition = '',
            sRoleId = '',
            sRoleName = '',
            isLogin = 0,
            isBind = 0,
            binData = {},
            isLoad = 0,
            goGame = window.location.protocol + '//speedm.qq.com/d/a20180212lester/play.html'; // 拉起游戏连接



        var activityUrl = actLinkM + '?acctype=wx&appid=' + wxappidM

        // 拉起QQ 登录
        function amsQQLogin() {
            if (!REGEXP_IOS_QQ.test(UA) && !REGEXP_ANDROID_QQ.test(UA)) {
                setTimeout(function () {
                    window.location.href = 'mqqapi://forward/url?url_prefix=' + btoa(actLinkM + '?_wv=49957') +
                        '&version=1&src_type=web'
                }, 200)
            } else {
                window.location.href = actLinkM + '?_wv=49957'
            }
        }

        // 拉起微信登录
        function amsWXLogin() {
            // openLink 尚未提供
        }

        // 角色选择器
        function selectRole(id) {
            if (isWeiXin()) {
                _server_url = window.location.protocol + '//gameact.qq.com/comm-htdocs/js/game_area/' + id +
                    '_WX_server_select.js'
            } else {
                _server_url = window.location.protocol + '//gameact.qq.com/comm-htdocs/js/game_area/' + id +
                    '_SQ_server_select.js'
            }
            include(_server_url + '?_rand=' + Math.random(), function () {
                checkLoop(id)
            })
        }

        // 角色选择后执行。
        function checkLoop(gameId) {
            need(['biz.roleselector'], function (RoleSelector) {
                var roleobj = cloneClass(RoleSelector)
                roleobj.init({
                    'type': 'html',
                    'gameId': gameId,
                    'isQueryRole': true,
                    // '_everyRead': true,
                    'area1ContentId': 'area1ContentId', // 如果为2级大区，则该值必须设置
                    'areaContentId': 'areaContentId',
                    'channelContentId': 'channelContentId', // 如果用不到可以删除
                    'systemContentId': 'systemContentId', // 如果用不到可以删除
                    'roleContentId': 'roleContentId',
                    'confirmButtonId': 'myGiftMainBtn',
                    'openToOpen': {
                        'sAMSTrusteeship': 1,
                        'ams_targetappid': ams_targetappid
                    },
                    'submitEvent': function (roleObj) {
                        isBind = true
                        sData.sRoleId = roleObj.submitData.roleid;
                        sData.sArea = roleObj.submitData.areaid;
                        sData.sPlatId = roleObj.submitData.sPlatId;
                        sData.sPartition = roleObj.submitData.sPartition;
                        console.log(roleObj);

                        amsCfg_619170.sData = sData;
                        amsCfg_619170.roleInfo = roleObj.submitData;
                        console.log(amsCfg_619170.roleInfo);
                        amsInit(267645, 619170);
                        alert(1);
                    }
                })
                roleobj.show()
            })
        }

        // 按钮并发锁
        var myLock = 0

        function btnLock() {
            myLock = 1
            console.log('do lock:' + myLock)
            setTimeout(function () {
                myLock = 0
                console.log('del lock:' + myLock)
            }, 2000)
        }

        sPlatId = isIos() ? '0' : (isAndroid() ? '1' : '')

        window.ams_login_avoid_conflict = true

        // ready
        milo.ready(function () {
            selectRole(serviceType);
            need('biz.login', function (LoginManager) {
                LoginManager.init({
                    appConfig: {
                        avoidConflict: true,
                        WxAppId: wxappidM,
                        scope: 'snsapi_userinfo'
                    }
                })

                LoginManager.checkLogin(function (userInfo) {
                    var acctype = milo.cookie.get('acctype')
                    if ((isWeiXin() && acctype != 'wx') || (isQQ() && acctype == 'wx')) {
                        LoginManager.logout({
                            logoutCallback: function () {
                                location.reload(true)
                            }
                        })
                        return
                    } else {
                        isLogin = true
                        if (isWeiXin()) {
                            appid = wxappidM
                            sArea = 1;
                            sData = {
                                'appid': appid,
                                'sArea': sArea,
                                'sServiceType': 'txyxhdh',
                                'ams_targetappid': ams_targetappid
                            }
                            LoginManager.getUserInfoByWxOpenId({
                                'openid': milo.cookie.get('openid'),
                                'access_token': milo.cookie.get('access_token')
                            }, function (wxuser) {
                                sRoleName = wxuser.nickname.replace(
                                    /<span[^>]*>([\s\S]*?)<\/span>/g, '')
                                sRoleName = milo.xss.filter(sRoleName);
                                //$(".myRoleName").text(sRoleName);
                            }, function () {
                                LoginManager.logout({
                                    logoutCallback: function () {
                                        location.reload(true)
                                    }
                                })
                            })
                        } else {
                            // qq登录
                            appid = qqappid
                            sArea = 2;
                            sData = {
                                'appid': appid,
                                'sArea': sArea,
                                'sServiceType': serviceType
                            }
                            sRoleName = LoginManager.getUin();
                            //$(".myRoleName").text(sRoleName);
                        }

                        alert('已登录');
                        amsCfg_619171.sData = sData;
                        amsInit(267645, 619171);
                    }
                }, function () {
                    isLogin = false
                    if (isWeiXin()) {
                        LoginManager.loginByWX({
                            redirect_wx_url: window.location.protocol +
                                "//iu.qq.com/wxauth/redirect.html?url=" +
                                encodeURIComponent(activityUrl),
                            scope: 'snsapi_userinfo ' //scope:snsapi_base,snsapi_userinfo  根据实际需要设置
                        })
                    } else if (isQQ() || milo.request('isQQ') == '1') {
                        LoginManager.login();
                    } else {
                        alert('未登录');
                    }
                }, {
                    appConfig: {
                        WxAppId: wxappidM,
                        scope: 'snsapi_userinfo'
                    }
                })
            })
        })


        //查询是否绑定的配置
        amsCfg_619171 = {
            type: "query",
            iQueryFlowID: 619170,
            success: function (bindedInfo) {
                console.log(bindedInfo);
                sData.sArea = bindedInfo.jData.data.Farea;
                sData.sPartition = bindedInfo.jData.data.FPartition;
                isBind = true;


            },
            failure: function () {
                //未绑定时的扩展处理
                isBind = 0;
            }
        };

        //提交绑定的配置
        amsCfg_619170 = {
            type: "comit",
            needPopupRole: false, //是否弹默认角色框选角色
            roleInfo: null, //如果needPopupRole为false，需要自定义传入角色信息，roleInfo需要传角色信息对象
            iQueryFlowID: 619171,
            service: "xiawa",
            success: function (bindedInfo) {
                console.log(bindedInfo);
                //已绑定时的扩展处理
                isBind = true;
                alert('角色绑定成功');
            },
            failure: function () {
                //未绑定时的扩展处理
            }
        };
        /***** H5 end **********************/
    </script>
    <script src="//ossweb-img.qq.com/images/js/PTT/ping_tcss_tgideas_https_min.js"></script>
    <script>
        //统计
        var setSite = {
            siteType: "a20191025kgshare",
            pageType: "index",
            pageName: "首页",
            osact: 0,
            ingame: 0,
            stayTime: 0
        };
        if (typeof (pgvMain) == 'function') pgvMain();
    </script>
</body>

</html>